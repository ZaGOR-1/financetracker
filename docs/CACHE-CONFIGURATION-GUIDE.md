# üì¶ –ö–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–æ –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–µ—à—É–≤–∞–Ω–Ω—è

## –û–≥–ª—è–¥

Finance Tracker –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –∫–µ—à—É–≤–∞–Ω–Ω—è –∑ –≥–Ω—É—á–∫–∏–º–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ —á–µ—Ä–µ–∑ `.env` —Ñ–∞–π–ª.

---

## üéõÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ .env

### –ë–∞–∑–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```env
# –î—Ä–∞–π–≤–µ—Ä –∫–µ—à—É–≤–∞–Ω–Ω—è
CACHE_DRIVER=file          # file, redis, memcached, database

# –ü—Ä–µ—Ñ—ñ–∫—Å –¥–ª—è –∫–ª—é—á—ñ–≤ –∫–µ—à—É
CACHE_PREFIX=finance_tracker
```

### TTL (Time To Live) –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö

–ß–∞—Å –∂–∏—Ç—Ç—è –∫–µ—à—É –≤ —Ö–≤–∏–ª–∏–Ω–∞—Ö:

```env
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—á–∞—Å—Ç–æ –∑–º—ñ–Ω—é—î—Ç—å—Å—è)
CACHE_TTL_STATS=5

# –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó (—Å–µ—Ä–µ–¥–Ω—è —á–∞—Å—Ç–æ—Ç–∞ –∑–º—ñ–Ω)
CACHE_TTL_TRANSACTIONS=10

# –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó (—Ä—ñ–¥–∫–æ –∑–º—ñ–Ω—é—é—Ç—å—Å—è)
CACHE_TTL_CATEGORIES=60

# –ë—é–¥–∂–µ—Ç–∏ (—Å–µ—Ä–µ–¥–Ω—è —á–∞—Å—Ç–æ—Ç–∞ –∑–º—ñ–Ω)
CACHE_TTL_BUDGETS=15

# –ö—É—Ä—Å–∏ –≤–∞–ª—é—Ç (–æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è —â–æ–¥–Ω—è)
CACHE_TTL_CURRENCY=1440

# –î–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—Ä—ñ–¥–∫–æ –∑–º—ñ–Ω—é—é—Ç—å—Å—è)
CACHE_TTL_USER=30
```

### –°—Ç—Ä–∞—Ç–µ–≥—ñ—è –∫–µ—à—É–≤–∞–Ω–Ω—è

–í–∏–±–µ—Ä—ñ—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –≤–∞—à–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞:

```env
# –û–ø—Ü—ñ—ó: aggressive, moderate, minimal
CACHE_STRATEGY=moderate
```

#### –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó:

| –°—Ç—Ä–∞—Ç–µ–≥—ñ—è | –ú–Ω–æ–∂–Ω–∏–∫ TTL | –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ |
|-----------|-------------|---------------------|
| **aggressive** | 2.0x | Production –∑ –≤–∏—Å–æ–∫–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º |
| **moderate** | 1.0x | –ó–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º) |
| **minimal** | 0.5x | Development –∞–±–æ —á–∞—Å—Ç—ñ –∑–º—ñ–Ω–∏ –¥–∞–Ω–∏—Ö |

**–ü—Ä–∏–∫–ª–∞–¥ –≤–ø–ª–∏–≤—É —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó:**
- `CACHE_TTL_STATS=5` + `CACHE_STRATEGY=aggressive` = 10 —Ö–≤–∏–ª–∏–Ω
- `CACHE_TTL_STATS=5` + `CACHE_STRATEGY=minimal` = 2.5 —Ö–≤–∏–ª–∏–Ω–∏

### –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –∫–µ—à—É–≤–∞–Ω–Ω—è

```env
# –£–≤—ñ–º–∫–Ω—É—Ç–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –∫–µ—à—É
CACHE_MONITORING_ENABLED=true

# –õ–æ–≥—É–≤–∞—Ç–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –∫–µ—à—É (cache misses)
CACHE_LOG_MISSES=false

# –õ–æ–≥—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∏
CACHE_LOG_SLOW_QUERIES=true

# –ü–æ—Ä—ñ–≥ –¥–ª—è –ø–æ–≤—ñ–ª—å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ (–º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∏)
CACHE_SLOW_QUERY_THRESHOLD=100
```

---

## üè¢ –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â

### Development

```env
CACHE_DRIVER=file
CACHE_STRATEGY=minimal
CACHE_MONITORING_ENABLED=true
CACHE_LOG_MISSES=true
CACHE_LOG_SLOW_QUERIES=true
```

**–ß–æ–º—É:**
- –®–≤–∏–¥–∫–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω (–∫–æ—Ä–æ—Ç–∫—ñ TTL)
- –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –¥–µ–±–∞–≥—É
- File driver (–Ω–µ –ø–æ—Ç—Ä–µ–±—É—î Redis/Memcached)

### Staging

```env
CACHE_DRIVER=redis
CACHE_STRATEGY=moderate
CACHE_MONITORING_ENABLED=true
CACHE_LOG_MISSES=true
CACHE_LOG_SLOW_QUERIES=true
```

**–ß–æ–º—É:**
- –ù–∞–±–ª–∏–∂–µ–Ω—ñ –¥–æ production —É–º–æ–≤–∏
- Redis –¥–ª—è –∫—Ä–∞—â–æ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### Production

```env
CACHE_DRIVER=redis
CACHE_STRATEGY=aggressive
CACHE_MONITORING_ENABLED=true
CACHE_LOG_MISSES=false
CACHE_LOG_SLOW_QUERIES=true
CACHE_SLOW_QUERY_THRESHOLD=200
```

**–ß–æ–º—É:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å (–¥–æ–≤–≥—ñ TTL)
- Redis –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø—É —Ç–∞ Cache Tags
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è (—Ç—ñ–ª—å–∫–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∏)

---

## üöÄ –ü–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ Redis (–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è Production)

### –ü–µ—Ä–µ–≤–∞–≥–∏ Redis:

‚úÖ **–®–≤–∏–¥—à–µ —á–∏—Ç–∞–Ω–Ω—è/–∑–∞–ø–∏—Å** - –≤ –ø–∞–º'—è—Ç—ñ –∑–∞–º—ñ—Å—Ç—å —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏  
‚úÖ **Cache Tags** - –≥—Ä—É–ø–æ–≤–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–µ—à—É  
‚úÖ **–ê—Ç–æ–º–∞—Ä–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó** - thread-safe  
‚úÖ **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤** - –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è  

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Redis:

#### Docker:
```bash
docker run -d -p 6379:6379 redis:alpine
```

#### Ubuntu/Debian:
```bash
sudo apt-get install redis-server
sudo systemctl start redis
sudo systemctl enable redis
```

#### macOS:
```bash
brew install redis
brew services start redis
```

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Laravel:

1. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ PHP extension:
```bash
# Ubuntu/Debian
sudo apt-get install php-redis

# macOS
pecl install redis
```

2. –û–Ω–æ–≤–∏—Ç–∏ `.env`:
```env
CACHE_DRIVER=redis
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=null
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä:
```bash
php artisan config:cache
php artisan cache:clear
```

---

## üîß API CacheService

### –û—Å–Ω–æ–≤–Ω—ñ –º–µ—Ç–æ–¥–∏:

```php
use App\Services\CacheService;

$cacheService = app(CacheService::class);

// –û—Ç—Ä–∏–º–∞—Ç–∏ –∞–±–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–µ—à
$data = $cacheService->remember('stats', $key, function() {
    return expensive_calculation();
});

// –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ –∫–µ—à
$cacheService->put('transactions', $key, $data);

// –û—Ç—Ä–∏–º–∞—Ç–∏ –∑ –∫–µ—à—É
$data = $cacheService->get('categories', $key, $default);

// –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å
if ($cacheService->has('budgets', $key)) {
    // ...
}

// –í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á
$cacheService->forget('stats', $key);

// –û—á–∏—Å—Ç–∏—Ç–∏ –≤–µ—Å—å –∫–µ—à –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
$cacheService->forgetUser($userId);

// –û—á–∏—Å—Ç–∏—Ç–∏ –∫–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
$cacheService->forgetUserTransactions($userId);
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è –∫–µ—à—É

–ö–µ—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—á–∏—â–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ Observers:

- **TransactionObserver** - –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ/–æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ/–≤–∏–¥–∞–ª–µ–Ω–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
- **CategoryObserver** - –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ/–æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ/–≤–∏–¥–∞–ª–µ–Ω–Ω—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
- **BudgetObserver** - –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ/–æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ/–≤–∏–¥–∞–ª–µ–Ω–Ω—ñ –±—é–¥–∂–µ—Ç—É

–ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Ä—É—á–Ω—É –æ—á–∏—â–∞—Ç–∏ –∫–µ—à –ø—ñ—Å–ª—è –∑–º—ñ–Ω!

---

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–µ—à—É

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –∫–µ—à—É:

```bash
# –û—á–∏—Å—Ç–∏—Ç–∏ –≤–µ—Å—å –∫–µ—à
php artisan cache:clear

# –ü–æ–∫–∞–∑–∞—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É Redis
redis-cli INFO stats

# –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
redis-cli MONITOR
```

### –õ–æ–≥—É–≤–∞–Ω–Ω—è:

–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ª–æ–≥–∏ –≤ `storage/logs/laravel.log`:

```bash
# –§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ø–æ cache
tail -f storage/logs/laravel.log | grep cache

# –§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∏
tail -f storage/logs/laravel.log | grep "slow query"
```

---

## üéØ Best Practices

### ‚úÖ DO:

1. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Redis –Ω–∞ Production**
   - –®–≤–∏–¥—à–µ —ñ –Ω–∞–¥—ñ–π–Ω—ñ—à–µ –∑–∞ file driver
   
2. **–ù–∞–ª–∞—à—Ç—É–π—Ç–µ TTL –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —á–∞—Å—Ç–æ—Ç–∏ –∑–º—ñ–Ω –¥–∞–Ω–∏—Ö**
   - –ß–∞—Å—Ç–æ –∑–º—ñ–Ω—é–≤–∞–Ω—ñ –¥–∞–Ω—ñ = –∫–æ—Ä–æ—Ç–∫—ñ TTL
   - –†—ñ–¥–∫–æ –∑–º—ñ–Ω—é–≤–∞–Ω—ñ = –¥–æ–≤–≥—ñ TTL

3. **–ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–µ—à—É**
   - –í—ñ–¥—Å—Ç–µ–∂—É–π—Ç–µ cache hit rate
   - –®—É–∫–∞–π—Ç–µ –ø–æ–≤—ñ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∏

4. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â**
   - Development: `minimal`
   - Production: `aggressive`

### ‚ùå DON'T:

1. **–ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `Cache::flush()` –Ω–∞–ø—Ä—è–º—É**
   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `CacheService->forgetUser()` –∞–±–æ —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏
   
2. **–ù–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–π—Ç–µ –∑–∞–Ω–∞–¥—Ç–æ –¥–æ–≤–≥—ñ TTL –¥–ª—è —á–∞—Å—Ç–æ –∑–º—ñ–Ω—é–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö**
   - –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –æ—Ç—Ä–∏–º–∞—é—Ç—å –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ –¥–∞–Ω—ñ

3. **–ù–µ –∫–µ—à—É–π—Ç–µ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ –±–µ–∑ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è**
   - –û—Å–æ–±–ª–∏–≤–æ –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ Redis

4. **–ù–µ –∑–∞–±—É–≤–∞–π—Ç–µ –ø—Ä–æ memory limits Redis**
   - –ù–∞–ª–∞—à—Ç—É–π—Ç–µ maxmemory policy

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–µ—à –Ω–µ –æ—á–∏—â–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–º—ñ–Ω

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –û—á–∏—Å—Ç–∏—Ç–∏ –≤–µ—Å—å –∫–µ—à
php artisan cache:clear

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞—Ü—é—é—Ç—å Observers
php artisan tinker
>>> \App\Models\Transaction::observe(\App\Observers\TransactionObserver::class);
```

### –ü—Ä–æ–±–ª–µ–º–∞: Redis connection refused

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å Redis
sudo systemctl status redis

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Redis
sudo systemctl restart redis

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
redis-cli ping
# –ú–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏: PONG
```

### –ü—Ä–æ–±–ª–µ–º–∞: Cache hit rate –Ω–∏–∑—å–∫–∏–π

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ó–±—ñ–ª—å—à—Ç–µ TTL –¥–ª—è —Ä—ñ–¥–∫–æ –∑–º—ñ–Ω—é–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö
2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é `aggressive`
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –Ω–µ –æ—á–∏—â—É—î—Ç—å—Å—è –∫–µ—à –∑–∞–Ω–∞–¥—Ç–æ —á–∞—Å—Ç–æ

---

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [Laravel Cache Documentation](https://laravel.com/docs/10.x/cache)
- [Redis Documentation](https://redis.io/documentation)
- [Cache Strategies Guide](https://aws.amazon.com/caching/best-practices/)

---

**–û–Ω–æ–≤–ª–µ–Ω–æ:** 2024  
**–í–µ—Ä—Å—ñ—è:** 1.0.0
